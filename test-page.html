<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnAI Extension Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #005a8b;
        }
        .output {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>ðŸŽ“ LearnAI Extension Test Page</h1>
    <p>This page helps test the LearnAI Chrome extension functionality.</p>
    
    <div class="test-section">
        <h2>Extension Status</h2>
        <div id="extensionStatus" class="status info">Checking extension...</div>
        <button class="button" onclick="checkExtensionStatus()">Check Status</button>
    </div>
    
    <div class="test-section">
        <h2>API Key Test</h2>
        <div id="apiStatus" class="status info">Testing API key...</div>
        <button class="button" onclick="testApiKey()">Test API Key</button>
    </div>
    
    <div class="test-section">
        <h2>LeetCode Simulation</h2>
        <p>Simulate a LeetCode problem interaction:</p>
        <textarea id="leetcodeCode" rows="4" cols="50" placeholder="Enter some code here...">
function twoSum(nums, target) {
    // Need help with approach
    return [];
}
        </textarea>
        <br>
        <button class="button" onclick="testLeetCode()">Get Tutoring Help</button>
        <div id="leetcodeOutput" class="output" style="display:none;"></div>
    </div>
    
    <div class="test-section">
        <h2>YouTube Simulation</h2>
        <p>Simulate a YouTube video interaction:</p>
        <input type="text" id="videoTitle" placeholder="Video title" value="Introduction to Data Structures" style="width: 100%; margin-bottom: 10px;">
        <textarea id="videoTranscript" rows="3" cols="50" placeholder="Video transcript excerpt...">
Arrays are fundamental data structures that store elements in contiguous memory locations. They provide O(1) access time but O(n) insertion time.
        </textarea>
        <br>
        <button class="button" onclick="testYouTube()">Generate Quiz</button>
        <div id="youtubeOutput" class="output" style="display:none;"></div>
    </div>
    
    <div class="test-section">
        <h2>General Content Test</h2>
        <p>Test with general web content:</p>
        <textarea id="generalContent" rows="4" cols="50" placeholder="Web page content...">
JavaScript is a high-level, interpreted programming language that conforms to the ECMAScript specification. It has dynamic typing, prototype-based object-orientation, and first-class functions.
        </textarea>
        <br>
        <input type="text" id="userQuestion" placeholder="Your question..." value="What are the key concepts I should focus on?" style="width: 100%; margin: 10px 0;">
        <button class="button" onclick="testGeneralContent()">Ask Question</button>
        <div id="generalOutput" class="output" style="display:none;"></div>
    </div>

    <script>
        // Check if extension is loaded
        function checkExtensionStatus() {
            const statusEl = document.getElementById('extensionStatus');
            
            if (typeof chrome !== 'undefined' && chrome.runtime && chrome.runtime.sendMessage) {
                chrome.runtime.sendMessage({ action: 'getApiKeyStatus' }, (response) => {
                    if (chrome.runtime.lastError) {
                        statusEl.className = 'status error';
                        statusEl.textContent = 'Extension not found or not loaded: ' + chrome.runtime.lastError.message;
                    } else {
                        statusEl.className = 'status success';
                        statusEl.textContent = 'Extension loaded successfully! API Key: ' + (response.hasApiKey ? 'Configured âœ“' : 'Not configured âœ—');
                    }
                });
            } else {
                statusEl.className = 'status error';
                statusEl.textContent = 'Chrome extension APIs not available. Make sure the extension is loaded.';
            }
        }

        // Test API key functionality
        function testApiKey() {
            const statusEl = document.getElementById('apiStatus');
            
            chrome.runtime.sendMessage({ action: 'getApiKeyStatus' }, (response) => {
                if (chrome.runtime.lastError) {
                    statusEl.className = 'status error';
                    statusEl.textContent = 'Error: ' + chrome.runtime.lastError.message;
                } else if (response.hasApiKey) {
                    statusEl.className = 'status success';
                    statusEl.textContent = 'API Key is configured and ready to use!';
                } else {
                    statusEl.className = 'status error';
                    statusEl.textContent = 'API Key not configured. Please set it in the extension popup.';
                }
            });
        }

        // Test LeetCode functionality
        function testLeetCode() {
            const code = document.getElementById('leetcodeCode').value;
            const outputEl = document.getElementById('leetcodeOutput');
            
            outputEl.style.display = 'block';
            outputEl.innerHTML = '<em>Generating response...</em>';
            
            const request = {
                action: 'generateTutorResponse',
                data: {
                    type: 'leetcode',
                    context: {
                        title: 'Two Sum',
                        difficulty: 'Easy',
                        description: 'Given an array of integers nums and an integer target, return indices of the two numbers such that they add up to target.',
                        selectedCode: code,
                        language: 'javascript'
                    },
                    requestedFeature: 'approach',
                    userQuery: 'How should I approach this problem?'
                }
            };
            
            chrome.runtime.sendMessage(request, (response) => {
                if (chrome.runtime.lastError) {
                    outputEl.innerHTML = '<strong>Error:</strong> ' + chrome.runtime.lastError.message;
                } else {
                    outputEl.innerHTML = '<strong>Response Type:</strong> ' + response.type + 
                                      '<br><strong>Content:</strong> ' + response.content +
                                      (response.nextSteps && response.nextSteps.length > 0 ? 
                                       '<br><strong>Next Steps:</strong><ul><li>' + response.nextSteps.join('</li><li>') + '</li></ul>' : '');
                }
            });
        }

        // Test YouTube functionality
        function testYouTube() {
            const title = document.getElementById('videoTitle').value;
            const transcript = document.getElementById('videoTranscript').value;
            const outputEl = document.getElementById('youtubeOutput');
            
            outputEl.style.display = 'block';
            outputEl.innerHTML = '<em>Generating quiz...</em>';
            
            const request = {
                action: 'generateTutorResponse',
                data: {
                    type: 'youtube',
                    context: {
                        title: title,
                        selectedText: transcript.substring(0, 100),
                        timestamp: 120,
                        transcript: transcript
                    },
                    requestedFeature: 'quiz',
                    userQuery: 'Can you create a quiz based on this content?'
                }
            };
            
            chrome.runtime.sendMessage(request, (response) => {
                if (chrome.runtime.lastError) {
                    outputEl.innerHTML = '<strong>Error:</strong> ' + chrome.runtime.lastError.message;
                } else {
                    outputEl.innerHTML = '<strong>Response Type:</strong> ' + response.type + 
                                      '<br><strong>Content:</strong> ' + response.content +
                                      (response.nextSteps && response.nextSteps.length > 0 ? 
                                       '<br><strong>Next Steps:</strong><ul><li>' + response.nextSteps.join('</li><li>') + '</li></ul>' : '');
                }
            });
        }

        // Test general content functionality
        function testGeneralContent() {
            const content = document.getElementById('generalContent').value;
            const question = document.getElementById('userQuestion').value;
            const outputEl = document.getElementById('generalOutput');
            
            outputEl.style.display = 'block';
            outputEl.innerHTML = '<em>Generating response...</em>';
            
            const request = {
                action: 'generateTutorResponse',
                data: {
                    type: 'general',
                    context: {
                        title: 'JavaScript Fundamentals',
                        url: window.location.href,
                        selectedText: content.substring(0, 200),
                        pageContent: content
                    },
                    userQuery: question
                }
            };
            
            chrome.runtime.sendMessage(request, (response) => {
                if (chrome.runtime.lastError) {
                    outputEl.innerHTML = '<strong>Error:</strong> ' + chrome.runtime.lastError.message;
                } else {
                    outputEl.innerHTML = '<strong>Response Type:</strong> ' + response.type + 
                                      '<br><strong>Content:</strong> ' + response.content +
                                      (response.nextSteps && response.nextSteps.length > 0 ? 
                                       '<br><strong>Next Steps:</strong><ul><li>' + response.nextSteps.join('</li><li>') + '</li></ul>' : '');
                }
            });
        }

        // Auto-check extension status on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkExtensionStatus, 1000);
        });
    </script>
</body>
</html>